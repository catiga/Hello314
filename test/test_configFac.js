const TokenFactory = artifacts.require('TokenFactory');

const bytes = "0x60806040819052600b805460ff191690556200228e388190039081908339810160408190526200002f91620003f8565b858585600462000040848262000537565b5060056200004f838262000537565b506003819055604051620000639062000325565b604051809103906000f08015801562000080573d6000803e3d6000fd5b50600680546001600160a01b0319166001600160a01b03929092169190911790553415620000e4576006546040516001600160a01b03909116903480156108fc02916000818181858888f19350505050158015620000e2573d6000803e3d6000fd5b505b5050506127108183620000f8919062000619565b11156200014c5760405162461bcd60e51b815260206004820152601960248201527f7061727469616c20706172616d7320697320696e76616c69640000000000000060448201526064015b60405180910390fd5b600880546001600160a01b0319166001600160a01b038916179055600c8390558015620001925761271062000182828662000635565b6200018e91906200064f565b600a555b60008215620001b957612710620001aa848762000635565b620001b691906200064f565b90505b600081600a54620001cb919062000619565b1115620001fa57600854600a54620001fa916001600160a01b031690620001f490849062000619565b6200025b565b600081600a54876200020d919062000672565b62000219919062000672565b11156200024257620002423082600a548862000236919062000672565b620001f4919062000672565b5050600d805460ff191690555062000688945050505050565b6001600160a01b038216620002b35760405162461bcd60e51b815260206004820152601f60248201527f45524332303a206d696e7420746f20746865207a65726f206164647265737300604482015260640162000143565b8060036000828254620002c7919062000619565b90915550506001600160a01b0382166000818152600160209081526040808320805486019055518481527fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef910160405180910390a35050565b505050565b6101b780620020d783390190565b634e487b7160e01b600052604160045260246000fd5b600082601f8301126200035b57600080fd5b81516001600160401b038082111562000378576200037862000333565b604051601f8301601f19908116603f01168101908282118183101715620003a357620003a362000333565b81604052838152602092508683858801011115620003c057600080fd5b600091505b83821015620003e45785820183015181830184015290820190620003c5565b600093810190920192909252949350505050565b600080600080600080600060e0888a0312156200041457600080fd5b87516001600160a01b03811681146200042c57600080fd5b60208901519097506001600160401b03808211156200044a57600080fd5b620004588b838c0162000349565b975060408a01519150808211156200046f57600080fd5b506200047e8a828b0162000349565b955050606088015193506080880151925060a0880151915060c0880151905092959891949750929550565b600181811c90821680620004be57607f821691505b602082108103620004df57634e487b7160e01b600052602260045260246000fd5b50919050565b601f8211156200032057600081815260208120601f850160051c810160208610156200050e5750805b601f850160051c820191505b818110156200052f578281556001016200051a565b505050505050565b81516001600160401b0381111562000553576200055362000333565b6200056b81620005648454620004a9565b84620004e5565b602080601f831160018114620005a357600084156200058a5750858301515b600019600386901b1c1916600185901b1785556200052f565b600085815260208120601f198616915b82811015620005d457888601518255948401946001909101908401620005b3565b5085821015620005f35787850151600019600388901b60f8161c191681555b5050505050600190811b01905550565b634e487b7160e01b600052601160045260246000fd5b808201808211156200062f576200062f62000603565b92915050565b80820281158282048414176200062f576200062f62000603565b6000826200066d57634e487b7160e01b600052601260045260246000fd5b500490565b818103818111156200062f576200062f62000603565b611a3f80620006986000396000f3fe6080604052600436106101c65760003560e01c806365029d82116100f7578063a9059cbb11610095578063dd62ed3e11610064578063dd62ed3e146104f5578063e773f0391461053b578063faa743e31461055b578063fea9dbbf1461057b57600080fd5b8063a9059cbb1461049e578063aa6764dc146104be578063b822ccaa146104c6578063d9443923146104db57600080fd5b806383f12fec116100d157806383f12fec146104365780638da5cb5b1461045657806395d89b41146104765780639a540abf1461048b57600080fd5b806365029d82146103c657806370a08231146103e65780637ec18cf61461041c57600080fd5b80631693e8d411610164578063313ce5671161013e578063313ce567146103435780633b97e8561461036557806351c6590a1461037b5780635b8bec551461038e57600080fd5b80631693e8d4146102ef57806318160ddd1461030e57806323b872dd1461032357600080fd5b80630902f1ac116101a05780630902f1ac14610255578063095ea7b31461028e57806311106ee2146102ae57806312a54b62146102ce57600080fd5b806301ffc9a7146101da57806304c0c4761461020f57806306fdde031461023357600080fd5b366101d5576101d361059a565b005b600080fd5b3480156101e657600080fd5b506101fa6101f53660046115ff565b61061b565b60405190151581526020015b60405180910390f35b34801561021b57600080fd5b5061022560005481565b604051908152602001610206565b34801561023f57600080fd5b50610248610652565b6040516102069190611630565b34801561026157600080fd5b50610279306000908152600160205260409020544791565b60408051928352602083019190915201610206565b34801561029a57600080fd5b506101fa6102a936600461169a565b6106e4565b3480156102ba57600080fd5b506102256102c93660046116c4565b6106fc565b3480156102da57600080fd5b506009546101fa90600160a01b900460ff1681565b3480156102fb57600080fd5b50600d546101fa90610100900460ff1681565b34801561031a57600080fd5b50600354610225565b34801561032f57600080fd5b506101fa61033e3660046116f9565b61075d565b34801561034f57600080fd5b50600c5460405160ff9091168152602001610206565b34801561037157600080fd5b50610225600c5481565b6101d3610389366004611735565b610781565b34801561039a57600080fd5b506009546103ae906001600160a01b031681565b6040516001600160a01b039091168152602001610206565b3480156103d257600080fd5b506101d36103e1366004611806565b610895565b3480156103f257600080fd5b50610225610401366004611843565b6001600160a01b031660009081526001602052604090205490565b34801561042857600080fd5b50600b546101fa9060ff1681565b34801561044257600080fd5b506101d361045136600461185e565b610970565b34801561046257600080fd5b506008546103ae906001600160a01b031681565b34801561048257600080fd5b50610248610a74565b6101d36104993660046118a3565b610a83565b3480156104aa57600080fd5b506101fa6104b936600461169a565b610c20565b6101d3610c54565b3480156104d257600080fd5b506101d3610d15565b3480156104e757600080fd5b50600d546101fa9060ff1681565b34801561050157600080fd5b506102256105103660046118c9565b6001600160a01b03918216600090815260026020908152604080832093909416825291909152205490565b34801561054757600080fd5b506101d36105563660046118a3565b610d49565b34801561056757600080fd5b506101d3610576366004611735565b610d7c565b34801561058757600080fd5b506006546001600160a01b031631610225565b3060009081526001602052604081205447906105b69034611912565b6105c09190611929565b90506105cd303383610f11565b604080513481526000602082018190528183015260608101839052905133917f49926bbebe8474393f434dfa4f78694c0923efa07d19f2284518bfabd06eb737919081900360800190a25b50565b60006001600160e01b031982166301ffc9a760e01b148061064c57506001600160e01b03198216635b3db1e760e11b145b92915050565b6060600480546106619061194b565b80601f016020809104026020016040519081016040528092919081815260200182805461068d9061194b565b80156106da5780601f106106af576101008083540402835291602001916106da565b820191906000526020600020905b8154815290600101906020018083116106bd57829003601f168201915b5050505050905090565b6000336106f28185856110cd565b5060019392505050565b6000806000610718306000908152600160205260409020544791565b9150915083156107495761072c8583611985565b6107368287611912565b6107409190611929565b9250505061064c565b6107538582611985565b6107368387611912565b60003361076b8582856111e9565b610776858585610f11565b506001949350505050565b600054156107d05760405162461bcd60e51b8152602060048201526017602482015276131a5c5d5a591a5d1e48185b1c9958591e481859191959604a1b60448201526064015b60405180910390fd5b6000341161080e5760405162461bcd60e51b815260206004820152600b60248201526a139bc8115512081cd95b9d60aa1b60448201526064016107c7565b8043106108545760405162461bcd60e51b8152602060048201526014602482015273426c6f636b206e756d62657220746f6f206c6f7760601b60448201526064016107c7565b6000819055604080518281523460208201527fcb1652de9aeec38545fc281847b3dbfc89aab56dfa907b1ab68466f602c36fb491015b60405180910390a150565b6008546001600160a01b031633146108ef5760405162461bcd60e51b815260206004820181905260248201527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e657260448201526064016107c7565b600b5460ff16156109425760405162461bcd60e51b815260206004820152601760248201527f50726573616c6520616c726561647920656e61626c656400000000000000000060448201526064016107c7565b60008151600a546109539190611929565b905061095f8282610970565b5050600b805460ff19166001179055565b600082511180156109815750600081115b6109c45760405162461bcd60e51b8152602060048201526014602482015273696e76616c696420626174636820706172616d7360601b60448201526064016107c7565b60008183516109d39190611912565b33600090815260016020526040902054909150811115610a2c5760405162461bcd60e51b8152602060048201526014602482015273696e73756666696369656e742062616c616e636560601b60448201526064016107c7565b60005b8351811015610a6e57610a5c33858381518110610a4e57610a4e611998565b602002602001015185610f11565b80610a66816119ae565b915050610a2f565b50505050565b6060600580546106619061194b565b6008546001600160a01b03163314610add5760405162461bcd60e51b815260206004820181905260248201527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e657260448201526064016107c7565b600d5460ff1615610b2a5760405162461bcd60e51b8152602060048201526017602482015276131a5c5d5a591a5d1e48185b1c9958591e481859191959604a1b60448201526064016107c7565b600d805460ff1916600117905534610b725760405162461bcd60e51b815260206004820152600b60248201526a139bc8115512081cd95b9d60aa1b60448201526064016107c7565b8063ffffffff164310610bbe5760405162461bcd60e51b8152602060048201526014602482015273426c6f636b206e756d62657220746f6f206c6f7760601b60448201526064016107c7565b63ffffffff81166000819055600d805461ff001916610100179055600980546001600160a01b03191633179055604080519182523460208301527fcb1652de9aeec38545fc281847b3dbfc89aab56dfa907b1ab68466f602c36fb4910161088a565b6000306001600160a01b03841603610c4057610c3b82611275565b610c4b565b610c4b338484610f11565b50600192915050565b60003411610ca45760405162461bcd60e51b815260206004820152601960248201527f656e68616e63652076616c75652073686f756c6420677420300000000000000060448201526064016107c7565b6006546040516001600160a01b03909116903480156108fc02916000818181858888f19350505050158015610cdd573d6000803e3d6000fd5b5060405134815233907f8afa789178083b5e769bf1688be9b3cb5bb4051efbce39835efdc8b3e84dfc9c9060200160405180910390a2565b6009546001600160a01b03163314610d3f5760405162461bcd60e51b81526004016107c7906119c7565b610d476113c3565b565b6009546001600160a01b03163314610d735760405162461bcd60e51b81526004016107c7906119c7565b61061881611469565b33600090815260016020526040902054811115610dd25760405162461bcd60e51b8152602060048201526014602482015273696e73756666696369656e742062616c616e636560601b60448201526064016107c7565b60008111610e225760405162461bcd60e51b815260206004820152601c60248201527f726574726976652076616c75652073686f756c6420626520677420300000000060448201526064016107c7565b600060035411610e745760405162461bcd60e51b815260206004820152601b60248201527f546f74616c20737570706c792063616e6e6f74206265207a65726f000000000060448201526064016107c7565b60035460065460009190610e939084906001600160a01b031631611912565b610e9d9190611929565b9050610ea933836114cb565b60065460405163055d478960e01b8152336004820152602481018390526001600160a01b039091169063055d478990604401600060405180830381600087803b158015610ef557600080fd5b505af1158015610f09573d6000803e3d6000fd5b505050505050565b336000908152600760205260409020544363ffffffff90911603610f915760405162461bcd60e51b815260206004820152603160248201527f596f752063616e2774206d616b652074776f207472616e73616374696f6e7320604482015270696e207468652073616d6520626c6f636b60781b60648201526084016107c7565b336000908152600760209081526040808320805463ffffffff19164363ffffffff161790556001600160a01b038616835260019091529020548111156110285760405162461bcd60e51b815260206004820152602660248201527f45524332303a207472616e7366657220616d6f756e7420657863656564732062604482015265616c616e636560d01b60648201526084016107c7565b6001600160a01b03808416600090815260016020526040902080548390039055821661105c5760038054829003905561107b565b6001600160a01b03821660009081526001602052604090208054820190555b816001600160a01b0316836001600160a01b03167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef836040516110c091815260200190565b60405180910390a3505050565b6001600160a01b03831661112f5760405162461bcd60e51b8152602060048201526024808201527f45524332303a20617070726f76652066726f6d20746865207a65726f206164646044820152637265737360e01b60648201526084016107c7565b6001600160a01b0382166111905760405162461bcd60e51b815260206004820152602260248201527f45524332303a20617070726f766520746f20746865207a65726f206164647265604482015261737360f01b60648201526084016107c7565b6001600160a01b0383811660008181526002602090815260408083209487168084529482529182902085905590518481527f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92591016110c0565b6001600160a01b038381166000908152600260209081526040808320938616835292905220546000198114610a6e57818110156112685760405162461bcd60e51b815260206004820152601d60248201527f45524332303a20696e73756666696369656e7420616c6c6f77616e636500000060448201526064016107c7565b610a6e84848484036110cd565b30600090815260016020526040812054611290908390611985565b61129a4784611912565b6112a49190611929565b9050600081116112ec5760405162461bcd60e51b815260206004820152601360248201527253656c6c20616d6f756e7420746f6f206c6f7760681b60448201526064016107c7565b8047101561133c5760405162461bcd60e51b815260206004820152601c60248201527f496e73756666696369656e742045544820696e2072657365727665730000000060448201526064016107c7565b611347333084610f11565b604051339082156108fc029083906000818181858888f19350505050158015611374573d6000803e3d6000fd5b50604080516000808252602082018590528183018490526060820152905133917f49926bbebe8474393f434dfa4f78694c0923efa07d19f2284518bfabd06eb737919081900360800190a25050565b60005443116114075760405162461bcd60e51b815260206004820152601060248201526f131a5c5d5a591a5d1e481b1bd8dad95960821b60448201526064016107c7565b60405133904780156108fc02916000818181858888f19350505050158015611433573d6000803e3d6000fd5b506040514781527f9a5a8a32afd899e7f95003c6e21c9fab2d50e11992439d14472229180c60c7aa9060200160405180910390a1565b8063ffffffff16600054106114c05760405162461bcd60e51b815260206004820152601a60248201527f596f752063616e27742073686f7274656e206475726174696f6e00000000000060448201526064016107c7565b63ffffffff16600055565b6001600160a01b03821661152b5760405162461bcd60e51b815260206004820152602160248201527f45524332303a206275726e2066726f6d20746865207a65726f206164647265736044820152607360f81b60648201526084016107c7565b6001600160a01b0382166000908152600160205260409020548181101561159f5760405162461bcd60e51b815260206004820152602260248201527f45524332303a206275726e20616d6f756e7420657863656564732062616c616e604482015261636560f01b60648201526084016107c7565b6001600160a01b03831660008181526001602090815260408083208686039055600380548790039055518581529192917fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef910160405180910390a3505050565b60006020828403121561161157600080fd5b81356001600160e01b03198116811461162957600080fd5b9392505050565b600060208083528351808285015260005b8181101561165d57858101830151858201604001528201611641565b506000604082860101526040601f19601f8301168501019250505092915050565b80356001600160a01b038116811461169557600080fd5b919050565b600080604083850312156116ad57600080fd5b6116b68361167e565b946020939093013593505050565b600080604083850312156116d757600080fd5b82359150602083013580151581146116ee57600080fd5b809150509250929050565b60008060006060848603121561170e57600080fd5b6117178461167e565b92506117256020850161167e565b9150604084013590509250925092565b60006020828403121561174757600080fd5b5035919050565b634e487b7160e01b600052604160045260246000fd5b600082601f83011261177557600080fd5b8135602067ffffffffffffffff808311156117925761179261174e565b8260051b604051601f19603f830116810181811084821117156117b7576117b761174e565b6040529384528581018301938381019250878511156117d557600080fd5b83870191505b848210156117fb576117ec8261167e565b835291830191908301906117db565b979650505050505050565b60006020828403121561181857600080fd5b813567ffffffffffffffff81111561182f57600080fd5b61183b84828501611764565b949350505050565b60006020828403121561185557600080fd5b6116298261167e565b6000806040838503121561187157600080fd5b823567ffffffffffffffff81111561188857600080fd5b61189485828601611764565b95602094909401359450505050565b6000602082840312156118b557600080fd5b813563ffffffff8116811461162957600080fd5b600080604083850312156118dc57600080fd5b6118e58361167e565b91506118f36020840161167e565b90509250929050565b634e487b7160e01b600052601160045260246000fd5b808202811582820484141761064c5761064c6118fc565b60008261194657634e487b7160e01b600052601260045260246000fd5b500490565b600181811c9082168061195f57607f821691505b60208210810361197f57634e487b7160e01b600052602260045260246000fd5b50919050565b8082018082111561064c5761064c6118fc565b634e487b7160e01b600052603260045260246000fd5b6000600182016119c0576119c06118fc565b5060010190565b60208082526022908201527f596f7520617265206e6f7420746865206c69717569646974792070726f76696460408201526132b960f11b60608201526080019056fea2646970667358221220902d23b8b9dc96e9578b1d5fa11a69226c44837874a51e915993bbe2efdce7d464736f6c634300081400336080604052600080546001600160a01b03191633179055610192806100256000396000f3fe6080604052600436106100225760003560e01c8063055d47891461002e57600080fd5b3661002957005b600080fd5b34801561003a57600080fd5b5061004e610049366004610124565b610050565b005b6000546001600160a01b031633146100a25760405162461bcd60e51b815260206004820152601060248201526f1ad9595c195c8818d85b88191bc81a5d60821b60448201526064015b60405180910390fd5b804710156100e95760405162461bcd60e51b8152602060048201526014602482015273696e73756666696369656e742062616c616e636560601b6044820152606401610099565b6040516001600160a01b0383169082156108fc029083906000818181858888f1935050505015801561011f573d6000803e3d6000fd5b505050565b6000806040838503121561013757600080fd5b82356001600160a01b038116811461014e57600080fd5b94602093909301359350505056fea26469706673582212204da463089ed15e6caefd00813128076295ea7a2de206b27c01d7daeb5c93de8f64736f6c63430008140033";

contract('Config TokenFactory', (accounts) => {
    describe("config", function() {

        it(`should return Name:`, async () => {
            let factoryInstance = await TokenFactory.at('0x4BE7FC9c7408D2FB9B0B07D800B5DD7ad3aaaA0d')
            
            const codeHash = web3.utils.keccak256(bytes)
            console.log('codeHash ', codeHash);

            // console.log('setting new code hash...')
            // const setresult = await factoryInstance.configCode(codeHash, true)
            // console.log('set result:', setresult)

            
            const existTpls = await factoryInstance.getTpls()
            console.log(existTpls)

            const readResult = await factoryInstance.securityCodes(codeHash)
            console.log(readResult)

            const constructorArgs = web3.eth.abi.encodeParameters(
                ['address', 'string', 'string', 'uint256', 'uint256', 'uint256', 'uint256'],
                ['0xFaD652ad544a85c87F00285EB64acDa7d79E20B6', 'First Token 2510', 'FTN', web3.utils.toWei('99999', 'ether'), 9, 1000, 4500]
              );

            const deployResult = await factoryInstance.deployContract(bytes, constructorArgs)
            console.log('deployResult', deployResult)

            // 0xd459f38453570b16c156ca82f8814e8bcfc3a8e882646d8a7f744a683549e0c4



            // const owner = await novaProxyInstance.owner();
            // const impl = await novaProxyInstance.getImplementation()
            // const novaLogicInstanceAtProxyAddress = new web3.eth.Contract(NovaRouter.abi, novaProxyInstance.address);

            // await novaLogicInstanceAtProxyAddress.methods.initialize().send({ from: accounts[0], gasPrice:8000000000, gas:5000000 });
            // const selltax = await novaLogicInstanceAtProxyAddress.methods.sellTax().call()
            // console.log('owner', owner)
            // console.log('impl', impl)
            // console.log('sell tax', selltax)
            // console.log('accounts', accounts)

            // const result = await novaLogicInstanceAtProxyAddress.methods.adjustTax(20, 20).send({ from: accounts[0], gasPrice:8000000000, gas:5000000 });
            // console.log('adjust tax result', result)
            
            // const result = await novaLogicInstanceAtProxyAddress.methods.reinitialize(500000).send({ from: accounts[0], gasPrice:8000000000, gas:5000000 });
            // console.log('adjust reinitialize result', result)
            // novaLogicInstanceAtProxyAddress.methods.
        });
    })
  
});
